<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Release Notes &mdash; gjson-py 0.2.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="API" href="api.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> gjson-py
          </a>
              <div class="version">
                0.2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#v0-2-0-2022-10-24">v0.2.0 (2022-10-24)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#new-features">New features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#minor-improvements">Minor improvements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#miscellanea">Miscellanea</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#v0-1-0-2022-10-03">v0.1.0 (2022-10-03)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Minor improvements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bug-fixes">Bug fixes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Miscellanea</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#v0-0-5-2022-08-05">v0.0.5 (2022-08-05)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">New features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Minor improvements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#v0-0-4-2022-06-11">v0.0.4 (2022-06-11)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5">New features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">Minor improvements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">Miscellanea</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#v0-0-3-2022-06-11">v0.0.3 (2022-06-11)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id8">New features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">Bug fixes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">Miscellanea</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#v0-0-2-2022-05-31">v0.0.2 (2022-05-31)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id11">Bug fixes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">Miscellanea</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#v0-0-1-2022-05-22">v0.0.1 (2022-05-22)</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">gjson-py</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Release Notes</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/release.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="release-notes">
<h1>Release Notes<a class="headerlink" href="#release-notes" title="Permalink to this heading">¶</a></h1>
<section id="v0-2-0-2022-10-24">
<h2><a class="reference external" href="https://github.com/volans-/gjson-py/releases/tag/v0.2.0">v0.2.0</a> (2022-10-24)<a class="headerlink" href="#v0-2-0-2022-10-24" title="Permalink to this heading">¶</a></h2>
<section id="new-features">
<h3>New features<a class="headerlink" href="#new-features" title="Permalink to this heading">¶</a></h3>
<ul>
<li><p>Query parsing: fully rewrite of the query parser:</p>
<ul>
<li><p>Until now the parsing was mostly relying on a couple of regular expressions with lookbehind assertions to take
into account escaped characters. Although they were working fine and also allowed to sensibly speed up the first
development of gjson-py, they also had two major limitations:</p>
<ul class="simple">
<li><p>Could not work in all corner cases.</p></li>
<li><p>Prevented the implementation of the GJSON features still missing in gjson-py.</p></li>
</ul>
</li>
<li><p>The parsing has been completely refactored using a more standard parser approach, that allows to fine-tune the
parsing much more to cover all corner cases and also enables the development of GJSON features still missing.</p></li>
<li><p>There shouldn’t be any difference for normal queries, but some corner cases might now return a proper error.</p></li>
<li><p>Introduced a new <code class="docutils literal notranslate"><span class="pre">GJSONParseError</span></code> for parser-specific errors, that inherits from GJSONError and also provides
a graphic way to show where the parsing error occurred. Example output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GJSONParseError: Invalid or unsupported query part `invalid`.
Query: name.last.invalid
-----------------^
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</section>
<section id="minor-improvements">
<h3>Minor improvements<a class="headerlink" href="#minor-improvements" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Refactor code splitting it into multiple files:</p>
<ul>
<li><p>Restructure the gjson code to split it into multiple files for ease of development and maintenance.</p></li>
<li><p>Keep all the split modules as private except the exceptions one, and re-export everything from the gjson module
itself, both to keep backward compatibility and also for simplicity of use by the clients.</p></li>
</ul>
</li>
<li><p>Custom modifiers:</p>
<ul>
<li><p>Prevent to register custom modifiers with names that contains characters that are used by the GJSON grammair,
raising a GJSONError exception.</p></li>
</ul>
</li>
</ul>
</section>
<section id="miscellanea">
<h3>Miscellanea<a class="headerlink" href="#miscellanea" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>README: clarify naming for nested queries, based on feedback from <a class="reference external" href="https://github.com/volans-/gjson-py/issues/2">issue #2</a>. Also fix a typo.</p></li>
</ul>
</section>
</section>
<section id="v0-1-0-2022-10-03">
<h2><a class="reference external" href="https://github.com/volans-/gjson-py/releases/tag/v0.1.0">v0.1.0</a> (2022-10-03)<a class="headerlink" href="#v0-1-0-2022-10-03" title="Permalink to this heading">¶</a></h2>
<section id="id1">
<h3>Minor improvements<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Modifiers: add <code class="docutils literal notranslate"><span class="pre">&#64;top_n</span></code> modifier (not present in GJSON):</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>Add a <code class="docutils literal notranslate"><span class="pre">&#64;top_n</span></code> modifier that optionally accepts as options the number of top common items to return:
<code class="docutils literal notranslate"><span class="pre">&#64;top_n:{&quot;n&quot;:</span> <span class="pre">5}</span></code></p></li>
<li><p>If no options are provided all items are returned.</p></li>
<li><p>It requires a list of items as input and returns a dictionary with unique items as keys and the count of them as
values.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>Modifiers: add <code class="docutils literal notranslate"><span class="pre">&#64;sum_n</span></code> modifier (not present in GJSON):</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>Add a <code class="docutils literal notranslate"><span class="pre">&#64;sum_n</span></code> modifier that will work on a sequence of objects, grouping the items with the same value for a
given grouping key and sum the values of a sum key for each of them.</p></li>
<li><p>The options are mandatory and must specify the key to use for grouping and the key to use for summing:
<code class="docutils literal notranslate"><span class="pre">{&quot;group&quot;:</span> <span class="pre">&quot;somekey&quot;,</span> <span class="pre">&quot;sum&quot;:</span> <span class="pre">&quot;anotherkey&quot;}</span></code>. Optionally specifying the <code class="docutils literal notranslate"><span class="pre">n</span></code> parameter to just return the top N
results based on the summed value: <code class="docutils literal notranslate"><span class="pre">{&quot;group&quot;:</span> <span class="pre">&quot;somekey&quot;,</span> <span class="pre">&quot;sum&quot;:</span> <span class="pre">&quot;anotherkey&quot;,</span> <span class="pre">&quot;n&quot;:</span> <span class="pre">5}</span></code></p></li>
<li><p>It requires a list of objects as input and returns a dictionary with unique items as keys and the sum of their
values as values.</p></li>
</ul>
</div></blockquote>
</section>
<section id="bug-fixes">
<h3>Bug fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Output: fix unicode handling:</p>
<ul>
<li><p>Fix the default behaviour ensuring non-ASCII characters are returned as-is.</p></li>
<li><p>Add a new modifier <code class="docutils literal notranslate"><span class="pre">&#64;ascii</span></code>, that when set will escape all non-ASCII characters.</p></li>
</ul>
</li>
<li><p>CLI: fix encoding handling:</p>
<ul>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">surrogateescape</span></code> Python mode when reading the input and back when printing the output to prevent
failures when parsing the input and reducing the loss of data.</p></li>
</ul>
</li>
</ul>
</section>
<section id="id2">
<h3>Miscellanea<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>documentation: add mention to Debian packaging and the availability of Debian packages for the project.</p></li>
<li><p>Type hints: use native types when possible. Instead of importing from <code class="docutils literal notranslate"><span class="pre">typing</span></code> use directly the native types when
they support the <code class="docutils literal notranslate"><span class="pre">[]</span></code> syntax added in Python 3.9.</p></li>
<li><p>documentation: refactor the modifiers documentation to clearly split the GJSON modifiers supported by gjson-py and
the additional modifiers specific to gjson-py with more detailed explanation and example usage for the additional
ones.</p></li>
<li><p>setup.py: mark project as Beta for this <code class="docutils literal notranslate"><span class="pre">v0.1.0</span></code> release and add an additional keyword for PyPI indexing.</p></li>
</ul>
</section>
</section>
<section id="v0-0-5-2022-08-05">
<h2><a class="reference external" href="https://github.com/volans-/gjson-py/releases/tag/v0.0.5">v0.0.5</a> (2022-08-05)<a class="headerlink" href="#v0-0-5-2022-08-05" title="Permalink to this heading">¶</a></h2>
<section id="id3">
<h3>New features<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Queries: add support for the tilde operator:</p>
<ul>
<li><p>When performing queries on arrays, add support for the Go GJSON tilde operator to perform truthy-ness comparison.</p></li>
<li><p>The comparison is based on Python’s definition of truthy-ness, hence the actual results might differ from the ones
in the Go package.</p></li>
</ul>
</li>
</ul>
</section>
<section id="id4">
<h3>Minor improvements<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>documentation: add man page for the gjson binary.</p></li>
</ul>
</section>
</section>
<section id="v0-0-4-2022-06-11">
<h2><a class="reference external" href="https://github.com/volans-/gjson-py/releases/tag/v0.0.4">v0.0.4</a> (2022-06-11)<a class="headerlink" href="#v0-0-4-2022-06-11" title="Permalink to this heading">¶</a></h2>
<section id="id5">
<h3>New features<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>CLI: improve the JSON Lines support allowing to use the <code class="docutils literal notranslate"><span class="pre">-l/--lines</span></code> CLI argument and the special query prefix
<code class="docutils literal notranslate"><span class="pre">..</span></code> syntax together to encapsulate each parsed line in an array to enable filtering using the Queries
capabilities.</p></li>
</ul>
</section>
<section id="id6">
<h3>Minor improvements<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>CLI: the input file CLI argument is now optional, defaulting to read from stdin. The equivalent of passing <code class="docutils literal notranslate"><span class="pre">-</span></code>.</p></li>
<li><p>Modifiers: add support for the upstream Go GJSON modifier <code class="docutils literal notranslate"><span class="pre">&#64;this</span></code>, that just returns the current object.</p></li>
</ul>
</section>
<section id="id7">
<h3>Miscellanea<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Documentation: add a section to with examples on how to use the CLI.</p></li>
<li><p>CLI: add a link at the bottom of the help message of the CLI to the online documentation.</p></li>
</ul>
</section>
</section>
<section id="v0-0-3-2022-06-11">
<h2><a class="reference external" href="https://github.com/volans-/gjson-py/releases/tag/v0.0.3">v0.0.3</a> (2022-06-11)<a class="headerlink" href="#v0-0-3-2022-06-11" title="Permalink to this heading">¶</a></h2>
<section id="id8">
<h3>New features<a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Add CLI support for JSON Lines:</p>
<ul>
<li><p>Add a <code class="docutils literal notranslate"><span class="pre">-l/--lines</span></code> CLI argument to specify that the input file/stream is made of one JSON per line.</p></li>
<li><p>When used, gjson applies the same query to all lines.</p></li>
<li><p>Based on the verbosity level the failing lines are completely ignored, an error message is printed to stderr or
the execution is interrupted at the first error printing the full traceback.</p></li>
</ul>
</li>
<li><p>Add CLI support for GJSON JSON Lines queries:</p>
<ul>
<li><p>Add support for the GJSON queries that encapsulates a JSON Lines input in an array when the query starts with
<code class="docutils literal notranslate"><span class="pre">..</span></code> so that they the data can be queries as if it was an array of objects in the CLI.</p></li>
</ul>
</li>
<li><p>Add support for custom modifiers:</p>
<ul>
<li><p>Add a <code class="docutils literal notranslate"><span class="pre">ModifierProtocol</span></code> to describe the interface that custom modifiers callable need to have.</p></li>
<li><p>Add a <code class="docutils literal notranslate"><span class="pre">register_modifier()</span></code> method in the <code class="docutils literal notranslate"><span class="pre">GJSON</span></code> class to register custom modifiers.</p></li>
<li><p>Allow to pass a dictionary of modifiers to the low-level <code class="docutils literal notranslate"><span class="pre">GJSONObj</span></code> class constructor.</p></li>
<li><p>Add a <code class="docutils literal notranslate"><span class="pre">GJSONObj.builtin_modifiers()</span></code> static method that returns a set with the names of the built-in modifiers.</p></li>
<li><p>Is not possible to register a custom modifier with the same name of a built-in modifier.</p></li>
<li><p>Clarify in the documentation that only JSON objects are accepted as modifier arguments.</p></li>
</ul>
</li>
</ul>
</section>
<section id="id9">
<h3>Bug fixes<a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Query parsing: when using the queries GJSON syntax <code class="docutils literal notranslate"><span class="pre">#(...)</span></code> and <code class="docutils literal notranslate"><span class="pre">#(...)#</span></code> fix the return value in case of a key
matching that doesn’t match any element.</p></li>
<li><p>Query parsing fixes/improvements found with the Python fuzzing engine Atheris:</p>
<ul>
<li><p>If any query parts between delimiters is empty error out with a specific message instead of hitting a generic
<code class="docutils literal notranslate"><span class="pre">IndexError</span></code>.</p></li>
<li><p>When a query has an integer index on a mapping object, in case the element is not present, raise a <code class="docutils literal notranslate"><span class="pre">GJSONError</span></code>
instead of a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> one.</p></li>
<li><p>When the query has a wildcard matching, ensure that it’s applied on a mapping object. Fail with a <code class="docutils literal notranslate"><span class="pre">GJSONError</span></code>
otherwise.</p></li>
<li><p>Explicitly catch malformed modifier options and raise a <code class="docutils literal notranslate"><span class="pre">GJSONError</span></code> instead.</p></li>
<li><p>If the last part of the query is a <code class="docutils literal notranslate"><span class="pre">#</span></code>, check that the object is actually a sequence like object and fail with
a specific message if not.</p></li>
<li><p>Ensure all the conditions are valid before attempting to extract the inner element of a sequence like object.
Ignore both non-mapping like objects inside the sequence or mapping like objects that don’t have the specified key.</p></li>
<li><p>When parsing the query value as JSON catch the eventual decoding error to encapsulate it into a <code class="docutils literal notranslate"><span class="pre">GJSONError</span></code> one.</p></li>
<li><p>When using the queries GJSON syntax <code class="docutils literal notranslate"><span class="pre">#(...)</span></code> and <code class="docutils literal notranslate"><span class="pre">#(...)#</span></code> accept also an empty query to follow the same
behaviour of the upstream Go GJSON.</p></li>
<li><p>When using the queries GJSON syntax <code class="docutils literal notranslate"><span class="pre">#(...)</span></code> and <code class="docutils literal notranslate"><span class="pre">#(...)#</span></code> follow closely the upstream behaviour of Go GJSON
for all items queries <code class="docutils literal notranslate"><span class="pre">#(..)#</span></code> with regex matching.</p></li>
<li><p>When using the queries GJSON syntax <code class="docutils literal notranslate"><span class="pre">#(...)</span></code> and <code class="docutils literal notranslate"><span class="pre">#(...)#</span></code> fix the wildcard matching regular expression when
using pattern matching.</p></li>
<li><p>Fix the regex to match keys in presence of wildcards escaping only the non-wildcards and ensuring to not
double-escaping any already escaped wildcard.</p></li>
<li><p>When using the queries GJSON syntax <code class="docutils literal notranslate"><span class="pre">#(...)</span></code> and <code class="docutils literal notranslate"><span class="pre">#(...)#</span></code> ensure any exception raised while comparing
incompatible objects is catched and raise as a GJSONError.</p></li>
</ul>
</li>
</ul>
</section>
<section id="id10">
<h3>Miscellanea<a class="headerlink" href="#id10" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>tests: when matching exception messages always escape the string or use raw strings to avoid false matchings.</p></li>
<li><p>pylint: remove unnecessary comments</p></li>
</ul>
</section>
</section>
<section id="v0-0-2-2022-05-31">
<h2><a class="reference external" href="https://github.com/volans-/gjson-py/releases/tag/v0.0.2">v0.0.2</a> (2022-05-31)<a class="headerlink" href="#v0-0-2-2022-05-31" title="Permalink to this heading">¶</a></h2>
<section id="id11">
<h3>Bug fixes<a class="headerlink" href="#id11" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&#64;sort</span></code> modifier: fix the actual sorting.</p></li>
<li><p>tests: ensure that mapping-like objects are compared also in the order of their keys.</p></li>
</ul>
</section>
<section id="id12">
<h3>Miscellanea<a class="headerlink" href="#id12" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>GitHub actions: add workflow to run tox.</p></li>
<li><p>GitHub actions: fix branch name for pushes</p></li>
<li><p>documentation: include also the <code class="docutils literal notranslate"><span class="pre">&#64;sort</span></code> modifier that is not present in the GJSON project.</p></li>
<li><p>documentation: fix link to PyPI package.</p></li>
<li><p>documentation: add link to the generated docs.</p></li>
<li><p>documentation: fix section hierarchy and build.</p></li>
</ul>
</section>
</section>
<section id="v0-0-1-2022-05-22">
<h2><a class="reference external" href="https://github.com/volans-/gjson-py/releases/tag/v0.0.1">v0.0.1</a> (2022-05-22)<a class="headerlink" href="#v0-0-1-2022-05-22" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Initial version.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="api.html" class="btn btn-neutral float-left" title="API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Riccardo Coccioli.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>